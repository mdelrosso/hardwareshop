USE [master]
GO
/****** Object:  Database [HS]    Script Date: 10/21/2014 11:27:12 ******/
CREATE DATABASE [HS]
GO
ALTER DATABASE [HS] SET COMPATIBILITY_LEVEL = 100
GO
IF (1 = FULLTEXTSERVICEPROPERTY('IsFullTextInstalled'))
begin
EXEC [HS].[dbo].[sp_fulltext_database] @action = 'enable'
end
GO
ALTER DATABASE [HS] SET ANSI_NULL_DEFAULT OFF
GO
ALTER DATABASE [HS] SET ANSI_NULLS OFF
GO
ALTER DATABASE [HS] SET ANSI_PADDING OFF
GO
ALTER DATABASE [HS] SET ANSI_WARNINGS OFF
GO
ALTER DATABASE [HS] SET ARITHABORT OFF
GO
ALTER DATABASE [HS] SET AUTO_CLOSE OFF
GO
ALTER DATABASE [HS] SET AUTO_CREATE_STATISTICS ON
GO
ALTER DATABASE [HS] SET AUTO_SHRINK OFF
GO
ALTER DATABASE [HS] SET AUTO_UPDATE_STATISTICS ON
GO
ALTER DATABASE [HS] SET CURSOR_CLOSE_ON_COMMIT OFF
GO
ALTER DATABASE [HS] SET CURSOR_DEFAULT  GLOBAL
GO
ALTER DATABASE [HS] SET CONCAT_NULL_YIELDS_NULL OFF
GO
ALTER DATABASE [HS] SET NUMERIC_ROUNDABORT OFF
GO
ALTER DATABASE [HS] SET QUOTED_IDENTIFIER OFF
GO
ALTER DATABASE [HS] SET RECURSIVE_TRIGGERS OFF
GO
ALTER DATABASE [HS] SET  DISABLE_BROKER
GO
ALTER DATABASE [HS] SET AUTO_UPDATE_STATISTICS_ASYNC OFF
GO
ALTER DATABASE [HS] SET DATE_CORRELATION_OPTIMIZATION OFF
GO
ALTER DATABASE [HS] SET TRUSTWORTHY OFF
GO
ALTER DATABASE [HS] SET ALLOW_SNAPSHOT_ISOLATION OFF
GO
ALTER DATABASE [HS] SET PARAMETERIZATION SIMPLE
GO
ALTER DATABASE [HS] SET READ_COMMITTED_SNAPSHOT OFF
GO
ALTER DATABASE [HS] SET HONOR_BROKER_PRIORITY OFF
GO
ALTER DATABASE [HS] SET  READ_WRITE
GO
ALTER DATABASE [HS] SET RECOVERY SIMPLE
GO
ALTER DATABASE [HS] SET  MULTI_USER
GO
ALTER DATABASE [HS] SET PAGE_VERIFY CHECKSUM
GO
ALTER DATABASE [HS] SET DB_CHAINING OFF
GO

/****** Object:  Table [dbo].[PERMISO]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[PERMISO](
	[Per_Id] [int] IDENTITY(1,1) NOT NULL,
	[Per_Nombre] [varchar](50) NOT NULL,
	[Per_Descripcion] [varchar](255) NULL,
	[Per_Eliminado] [bit] NULL,
 CONSTRAINT [PK_PERMISO] PRIMARY KEY CLUSTERED 
(
	[Per_Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO

SET IDENTITY_INSERT [dbo].[PERMISO] ON
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (1, N'ADMINISTRACION', N'Administracion del Sistema', 0)
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (2, N'ADMIN_USUARIOS', N'Administracion de usuarios', 0)
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (3, N'ADMIN_PERMISOS', N'Administracion de Permisos', 0)
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (4, N'ADMIN_PERFILES', N'Administracion de Perfiles', 0)
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (5, N'BORRARME', N'BORRARME', 1)
INSERT [dbo].[PERMISO] ([Per_Id], [Per_Nombre], [Per_Descripcion], [Per_Eliminado]) VALUES (6, N'USUARIOFINAL', N'Funcionalidades del Sistema', 0)
SET IDENTITY_INSERT [dbo].[PERMISO] OFF

/****** Object:  Table [dbo].[PERMISOFAMILIA]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PERMISOFAMILIA](
	[Pefa_PermisoPadreId] [int] NOT NULL,
	[Pefa_PermisoHijoId] [int] NOT NULL,
 CONSTRAINT [PK_PERMISOFAMILIA] PRIMARY KEY CLUSTERED 
(
	[Pefa_PermisoPadreId] ASC,
	[Pefa_PermisoHijoId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[PERMISOFAMILIA]  WITH CHECK ADD  CONSTRAINT [FK_PERMISOFAMILIA_PERMISO] FOREIGN KEY([Pefa_PermisoPadreId])
REFERENCES [dbo].[PERMISO] ([Per_Id])
GO
ALTER TABLE [dbo].[PERMISOFAMILIA] CHECK CONSTRAINT [FK_PERMISOFAMILIA_PERMISO]
GO
ALTER TABLE [dbo].[PERMISOFAMILIA]  WITH CHECK ADD  CONSTRAINT [FK_PERMISOFAMILIA_PERMISO1] FOREIGN KEY([Pefa_PermisoHijoId])
REFERENCES [dbo].[PERMISO] ([Per_Id])
GO
ALTER TABLE [dbo].[PERMISOFAMILIA] CHECK CONSTRAINT [FK_PERMISOFAMILIA_PERMISO1]
GO

INSERT [dbo].[PERMISOFAMILIA] ([Pefa_PermisoPadreId], [Pefa_PermisoHijoId]) VALUES (1, 2)
INSERT [dbo].[PERMISOFAMILIA] ([Pefa_PermisoPadreId], [Pefa_PermisoHijoId]) VALUES (1, 3)
INSERT [dbo].[PERMISOFAMILIA] ([Pefa_PermisoPadreId], [Pefa_PermisoHijoId]) VALUES (1, 4)
INSERT [dbo].[PERMISOFAMILIA] ([Pefa_PermisoPadreId], [Pefa_PermisoHijoId]) VALUES (1, 6)
/****** Object:  Table [dbo].[USUARIO]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[USUARIO](
	[Usu_Id] [int] IDENTITY(1,1) NOT NULL,
	[Usu_Nombre] [varchar](16) NOT NULL,
	[Usu_Clave] [nvarchar](512) NOT NULL,
	[Usu_Email] [varchar](50) NOT NULL,
	[Usu_Bloqueado] [bit] NOT NULL,
	[Usu_Eliminado] [bit] NULL,
	[DIGITOHORIZONTAL] [bigint] NULL,
 CONSTRAINT [PK_USUARIO] PRIMARY KEY CLUSTERED 
(
	[Usu_Id] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO

SET IDENTITY_INSERT [dbo].[USUARIO] ON
INSERT [dbo].[USUARIO] ([Usu_Id], [Usu_Nombre], [Usu_Clave], [Usu_Email], [Usu_Bloqueado], [Usu_Eliminado], [DIGITOHORIZONTAL]) VALUES (1, N'root', N'1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75', N'root@gmail.com', 0, 0, 586198)
INSERT [dbo].[USUARIO] ([Usu_Id], [Usu_Nombre], [Usu_Clave], [Usu_Email], [Usu_Bloqueado], [Usu_Eliminado], [DIGITOHORIZONTAL]) VALUES (2, N'admin', N'1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75', N'admnin@gmail.com', 0, 0, 589678)
INSERT [dbo].[USUARIO] ([Usu_Id], [Usu_Nombre], [Usu_Clave], [Usu_Email], [Usu_Bloqueado], [Usu_Eliminado], [DIGITOHORIZONTAL]) VALUES (3, N'guest', N'1f40fc92da241694750979ee6cf582f2d5d7d28e18335de05abc54d0560e0f5302860c652bf08d560252aa5e74210546f369fbbbce8c12cfc7957b2652fe9a75', N'guest@gmail.com', 0, 0, 588245)
GO
SET IDENTITY_INSERT [dbo].[USUARIO] OFF
/****** Object:  Table [dbo].[USUARIOPERMISO]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[USUARIOPERMISO](
	[UsPe_UsuarioId] [int] NOT NULL,
	[UsPe_PermisoId] [int] NOT NULL,
 CONSTRAINT [PK_USUARIOPERMISO] PRIMARY KEY CLUSTERED 
(
	[UsPe_UsuarioId] ASC,
	[UsPe_PermisoId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[USUARIOPERMISO]  WITH CHECK ADD  CONSTRAINT [FK_USUARIOPERMISO_PERMISO] FOREIGN KEY([UsPe_PermisoId])
REFERENCES [dbo].[PERMISO] ([Per_Id])
GO
ALTER TABLE [dbo].[USUARIOPERMISO] CHECK CONSTRAINT [FK_USUARIOPERMISO_PERMISO]
GO
ALTER TABLE [dbo].[USUARIOPERMISO]  WITH CHECK ADD  CONSTRAINT [FK_USUARIOPERMISO_USUARIO] FOREIGN KEY([UsPe_UsuarioId])
REFERENCES [dbo].[USUARIO] ([Usu_Id])
GO
ALTER TABLE [dbo].[USUARIOPERMISO] CHECK CONSTRAINT [FK_USUARIOPERMISO_USUARIO]
GO
INSERT [dbo].[USUARIOPERMISO] ([UsPe_UsuarioId], [UsPe_PermisoId]) VALUES (1, 1)
INSERT [dbo].[USUARIOPERMISO] ([UsPe_UsuarioId], [UsPe_PermisoId]) VALUES (2, 2)
INSERT [dbo].[USUARIOPERMISO] ([UsPe_UsuarioId], [UsPe_PermisoId]) VALUES (2, 4)
INSERT [dbo].[USUARIOPERMISO] ([UsPe_UsuarioId], [UsPe_PermisoId]) VALUES (3, 6)

/****** Object:  Table [dbo].[BITACORA]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[BITACORA](
	[IDBITACORA] [bigint] IDENTITY(1,1) NOT NULL,
	[DIGITOHORIZONTAL] [bigint] NOT NULL,
	[LOG] [nvarchar](255) NOT NULL,
	[ELIMINADO] [bit] NOT NULL,
 CONSTRAINT [PK_BITACORA] PRIMARY KEY CLUSTERED 
(
	[IDBITACORA] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET IDENTITY_INSERT [dbo].[BITACORA] ON
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (12, 53504, N'12/10/2017 01:02:13 a.m.|guest|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (13, 50246, N'12/10/2017 01:02:20 a.m.|root|Intento de Login con xito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (14, 53579, N'12/10/2017 01:03:34 a.m.|guest|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (15, 53091, N'12/10/2017 01:04:09 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (16, 53057, N'12/10/2017 01:43:41 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (17, 53084, N'12/10/2017 02:04:53 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (18, 53055, N'12/10/2017 02:12:07 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (19, 53122, N'12/10/2017 02:14:54 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (20, 53122, N'12/10/2017 02:15:45 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (21, 53046, N'12/10/2017 02:16:31 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (22, 53128, N'12/10/2017 02:23:46 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (23, 53389, N'12/10/2017 07:11:24 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (24, 53099, N'14/10/2017 01:01:48 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (25, 53046, N'14/10/2017 01:08:03 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (26, 53143, N'14/10/2017 01:08:08 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (27, 52937, N'14/10/2017 01:10:03 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (28, 52995, N'14/10/2017 01:10:15 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (29, 53041, N'14/10/2017 01:14:23 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (30, 53098, N'14/10/2017 01:14:45 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (31, 52987, N'14/10/2017 01:15:02 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (32, 53113, N'14/10/2017 01:17:34 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (33, 53168, N'14/10/2017 01:18:45 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (34, 53094, N'14/10/2017 01:19:13 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (35, 53133, N'14/10/2017 01:19:24 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (36, 52913, N'14/10/2017 01:20:01 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (37, 53000, N'14/10/2017 01:22:40 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (38, 53154, N'14/10/2017 01:22:48 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (39, 53119, N'14/10/2017 01:23:09 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (40, 53061, N'14/10/2017 01:24:06 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (41, 53081, N'14/10/2017 01:24:16 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (42, 53025, N'14/10/2017 01:24:22 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (43, 53025, N'14/10/2017 01:24:40 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (44, 53111, N'14/10/2017 01:30:47 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (45, 52960, N'14/10/2017 01:31:20 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (46, 53094, N'14/10/2017 01:32:08 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (47, 53073, N'14/10/2017 01:33:15 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (48, 53086, N'14/10/2017 01:43:51 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (49, 53193, N'14/10/2017 01:55:45 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (50, 53155, N'14/10/2017 01:56:34 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (51, 53080, N'14/10/2017 01:57:11 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (52, 53176, N'14/10/2017 02:05:39 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (53, 53156, N'14/10/2017 02:06:37 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (54, 53226, N'14/10/2017 02:08:57 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (55, 53229, N'14/10/2017 02:17:39 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (56, 53134, N'14/10/2017 02:27:15 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (57, 53169, N'14/10/2017 02:29:06 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (58, 53093, N'14/10/2017 02:38:11 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (59, 53264, N'14/10/2017 02:38:38 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (60, 53111, N'14/10/2017 02:39:30 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (61, 53104, N'14/10/2017 02:45:14 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (62, 48623, N'14/10/2017 01:13:12 p.m.|root|Intento de Login fallido|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (63, 53467, N'14/10/2017 01:18:44 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (64, 48694, N'14/10/2017 01:25:04 p.m.|root|Intento de Login fallido|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (65, 53403, N'14/10/2017 01:25:15 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (66, 53385, N'14/10/2017 01:25:23 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (67, 53490, N'14/10/2017 01:28:44 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (68, 53301, N'14/10/2017 01:31:30 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (69, 53388, N'14/10/2017 01:35:13 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (70, 53346, N'14/10/2017 01:37:10 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (71, 53364, N'14/10/2017 01:40:25 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (72, 53341, N'14/10/2017 01:42:22 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (73, 53474, N'14/10/2017 01:58:14 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (74, 53454, N'14/10/2017 01:59:12 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (75, 53399, N'14/10/2017 02:01:19 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (76, 53368, N'14/10/2017 02:05:32 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (77, 53349, N'14/10/2017 02:06:21 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (78, 53445, N'14/10/2017 02:07:07 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (79, 53462, N'14/10/2017 02:07:44 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (80, 53365, N'14/10/2017 02:09:20 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (81, 53252, N'14/10/2017 02:12:10 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (82, 53354, N'14/10/2017 11:51:13 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (83, 53448, N'14/10/2017 11:52:17 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (84, 53440, N'14/10/2017 11:55:23 p.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (85, 53144, N'15/10/2017 12:19:41 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (86, 53082, N'15/10/2017 12:24:32 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (87, 53269, N'15/10/2017 12:25:59 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (88, 53223, N'15/10/2017 12:38:26 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (89, 53080, N'15/10/2017 10:22:17 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (90, 53118, N'15/10/2017 10:28:42 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (91, 53059, N'15/10/2017 10:33:06 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (92, 53051, N'15/10/2017 10:36:12 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (93, 53083, N'15/10/2017 10:41:17 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (94, 52968, N'15/10/2017 10:42:10 a.m.|root|Intento de Login con exito|3', 0)
INSERT [dbo].[BITACORA] ([IDBITACORA], [DIGITOHORIZONTAL], [LOG], [ELIMINADO]) VALUES (95, 53482, N'15/10/2017 12:33:28 p.m.|root|Intento de Login con exito|3', 0)
SET IDENTITY_INSERT [dbo].[BITACORA] OFF
/****** Object:  Table [dbo].[DIGITOVERIFICADOR]    Script Date: 10/21/2014 11:27:14 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
SET ANSI_PADDING ON
GO
CREATE TABLE [dbo].[DIGITOVERIFICADOR](
	[IDDIGITOVERIFICADOR] [bigint] IDENTITY(1,1) NOT NULL,
	[DIGITOVERTICAL] [bigint] NOT NULL,
	[TABLANOMBRE] [varchar](100) NOT NULL,
	[DIGITOHORIZONTAL] [bigint] NULL,
 CONSTRAINT [PK_DIGITOVERIFICADOR] PRIMARY KEY CLUSTERED 
(
	[IDDIGITOVERIFICADOR] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_PADDING OFF
GO
SET IDENTITY_INSERT [dbo].[DIGITOVERIFICADOR] ON
INSERT [dbo].[DIGITOVERIFICADOR] ([IDDIGITOVERIFICADOR], [DIGITOVERTICAL], [TABLANOMBRE], [DIGITOHORIZONTAL]) VALUES (1, 16826, N'BITACORA', 3477)
INSERT [dbo].[DIGITOVERIFICADOR] ([IDDIGITOVERIFICADOR], [DIGITOVERTICAL], [TABLANOMBRE], [DIGITOHORIZONTAL]) VALUES (2, 156, N'USUARIO', 2540)
INSERT [dbo].[DIGITOVERIFICADOR] ([IDDIGITOVERIFICADOR], [DIGITOVERTICAL], [TABLANOMBRE], [DIGITOHORIZONTAL]) VALUES (3, 156, N'DIGITOVERIFICADOR', 11714)
SET IDENTITY_INSERT [dbo].[DIGITOVERIFICADOR] OFF

/****** Object:  StoredProcedure [dbo].[HS_PERMISO_ELIMINAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_ELIMINAR]
	@id int, @eliminado bit=1
AS
BEGIN
	SET NOCOUNT OFF;

    UPDATE PERMISO 
		SET Per_Eliminado=@eliminado
		WHERE Per_Id=@id;
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_AGREGAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_AGREGAR]
	@nombre varchar(50), @descripcion varchar(255)=''
AS
BEGIN
	SET NOCOUNT OFF;

    INSERT INTO PERMISO VALUES(@nombre, @descripcion, 0);
    
    RETURN SCOPE_IDENTITY();
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_MODIFICAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_MODIFICAR]
	@nombre varchar(50), @descripcion varchar(255)='', @eliminado int=0, @id int
AS
BEGIN
	SET NOCOUNT OFF;

    UPDATE PERMISO 
		SET Per_Nombre=@nombre, Per_Descripcion=@descripcion, Per_Eliminado=@eliminado
		WHERE Per_Id=@id;
END
GO
/****** Object:  StoredProcedure [dbo].[HS_USUARIO_PERMISO_LISTAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_USUARIO_PERMISO_LISTAR]
	@usuarioId int, @permisoId int=NULL
AS
BEGIN
	SET NOCOUNT ON;
	
	-- Insert statements for procedure here
	SELECT per.Per_Id, per.Per_Nombre, per.Per_Descripcion, per.Per_Eliminado, 
		(SELECT COUNT(0) FROM PERMISOFAMILIA WHERE Pefa_PermisoPadreId=Per_Id) AS Cant_Hijos
		FROM PERMISO per LEFT JOIN  USUARIOPERMISO uspe ON (uspe.UsPe_PermisoId=per.Per_Id)		
		WHERE UsPe_UsuarioId=@usuarioId 
			AND (UsPe_PermisoId=@permisoId OR @permisoId IS NULL)
		ORDER BY per.Per_Nombre
END
GO
/****** Object:  StoredProcedure [dbo].[HS_USUARIO_PERMISO_ELIMINAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_USUARIO_PERMISO_ELIMINAR]
	@usuarioId int, @permisoId int
AS
BEGIN
	SET NOCOUNT OFF;
	DELETE FROM USUARIOPERMISO
		WHERE UsPe_UsuarioId=@usuarioId AND UsPe_PermisoId=@permisoId
END
GO
/****** Object:  StoredProcedure [dbo].[HS_USUARIO_PERMISO_AGREGAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_USUARIO_PERMISO_AGREGAR]
	@usuarioId int, @permisoId int
AS
BEGIN
	SET NOCOUNT OFF;
	IF (SELECT COUNT(0) FROM USUARIOPERMISO
		WHERE UsPe_UsuarioId=@usuarioId AND UsPe_PermisoId=@permisoId) = 0 BEGIN
		
		INSERT INTO USUARIOPERMISO VALUES(@usuarioId, @permisoId);
    END
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_LISTAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_LISTAR]
	@nombre varchar(50)=NULL, @descripcion varchar(255)=NULL,
	@eliminado bit=NULL, @id int=NULL
AS
BEGIN
	SET NOCOUNT ON;

    SELECT Per_Id, Per_Nombre, Per_Descripcion, Per_Eliminado, 
		(SELECT COUNT(0) FROM PERMISOFAMILIA WHERE Pefa_PermisoPadreId=Per_Id) AS Cant_Hijos
		FROM PERMISO 
		WHERE (Per_Id=@id OR @id IS NULL)
			AND (Per_Nombre LIKE '%'+@nombre+'%' OR @nombre IS NULL)
			AND (Per_Descripcion LIKE '%'+@descripcion+'%' OR @descripcion IS NULL)
			AND (Per_Eliminado=@eliminado OR @eliminado IS NULL)
		ORDER BY Per_Nombre;
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_FAMILIA_LISTAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_FAMILIA_LISTAR]
	@padreId int=NULL, @hijoId int=NULL
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    IF @padreId IS NOT NULL BEGIN
    -- Insert statements for procedure here
	SELECT per.Per_Id, per.Per_Nombre, per.Per_Descripcion, per.Per_Eliminado, 
		(SELECT COUNT(0) FROM PERMISOFAMILIA WHERE Pefa_PermisoHijoId=Per_Id) AS Cant_Hijos
		FROM PERMISO per LEFT JOIN PERMISOFAMILIA  pefa ON (per.Per_Id=pefa.Pefa_PermisoHijoId)
		WHERE (per.Per_Id=@hijoId OR @hijoId IS NULL)
			AND (pefa.Pefa_PermisoPadreId=@padreId OR @padreId IS NULL)
		ORDER BY Per_Nombre;
	END
	ELSE BEGIN
		SELECT per.Per_Id, per.Per_Nombre, per.Per_Descripcion, per.Per_Eliminado, 
		(SELECT COUNT(0) FROM PERMISOFAMILIA WHERE Pefa_PermisoHijoId=Per_Id) AS Cant_Hijos
		FROM PERMISO per LEFT JOIN PERMISOFAMILIA  pefa ON (per.Per_Id=pefa.Pefa_PermisoPadreId)
		WHERE (pefa.Pefa_PermisoPadreId=@padreId OR @padreId IS NULL)
			AND (pefa.Pefa_PermisoHijoId=@hijoid OR @hijoid IS NULL)
		ORDER BY Per_Nombre;
	END
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_FAMILIA_ELIMINAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_FAMILIA_ELIMINAR]
	@padreId int, @hijoId int=NULL
AS
BEGIN
	SET NOCOUNT OFF;
	
	DELETE FROM PERMISOFAMILIA 
		WHERE Pefa_PermisoPadreId=@padreId
			AND (Pefa_PermisoHijoId=@hijoId OR @hijoId IS NULL);
END
GO
/****** Object:  StoredProcedure [dbo].[HS_PERMISO_FAMILIA_AGREGAR]    Script Date: 10/21/2014 11:27:15 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[HS_PERMISO_FAMILIA_AGREGAR]
	@padreId int, @hijoId int
AS
BEGIN
	SET NOCOUNT OFF;

	IF (SELECT COUNT(0) FROM PERMISOFAMILIA 
		WHERE Pefa_PermisoPadreId=@padreId AND Pefa_PermisoHijoId=@hijoId)=0 BEGIN
		
		-- solo agregarlo si no existe ya la relacion
		INSERT INTO PERMISOFAMILIA VALUES(@padreId, @hijoId);
		
	END
END
GO
